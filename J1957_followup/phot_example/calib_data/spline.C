double Spline_evaluation(double x_in, double y_in)
{
    double tx [] = {5.1200000000000003E+01, 5.1200000000000003E+01, 5.1200000000000003E+01, 2.0763591185700935E+02, 3.7217452618648804E+02, 4.7388928361090427E+02, 7.5210189797335761E+02, 8.6547268953356797E+02, 1.0524006158305554E+03, 1.1233595877367829E+03, 1.2529765153776498E+03, 1.3306141498190475E+03, 1.3829338980459404E+03, 1.5913619201522299E+03, 1.6995407944183810E+03, 1.9362102170027331E+03, 2.1455294476813847E+03, 2.3783396953896308E+03, 2.5324303001689245E+03, 2.7164414629066109E+03, 2.9312154621424465E+03, 3.0208000000000002E+03, 3.0208000000000002E+03, 3.0208000000000002E+03};
    double ty [] = {5.1333300000000001E+01, 5.1333300000000001E+01, 5.1333300000000001E+01, 1.9990607456845780E+02, 3.7444106921930648E+02, 6.0532211409622710E+02, 8.1700657699006831E+02, 9.6347064455218003E+02, 1.0842821887242944E+03, 1.3747537619977879E+03, 1.4902466511183516E+03, 1.5938546407587753E+03, 1.8592986099791133E+03, 2.0575027914916086E+03, 2.1586900316889573E+03, 2.2711452290932593E+03, 2.3621634037346416E+03, 2.4459532251037490E+03, 2.6959612847604049E+03, 2.7928949950399583E+03, 2.9362946464927586E+03, 3.0286700000000001E+03, 3.0286700000000001E+03, 3.0286700000000001E+03};
    double coeff [] = {-4.8513609289387730E-03, -3.5653075334666955E-03, -1.5392886084588892E-03, -5.2574335602020303E-03, -4.9666967017791370E-03, -5.1554329591876821E-03, -4.7755086485571684E-03, -8.9514740590946433E-03, -6.7791199021809646E-03, -9.5339848686896121E-03, -1.4843297948229981E-02, -1.8642254360570508E-02, -1.6079968146170142E-02, -2.1797485685219168E-02, -1.6691119022555725E-02, -2.7430002691557237E-02, -2.5332644746997850E-02, -2.6971597657855461E-02, -3.4095325635278118E-02, -4.0792810027246502E-02, -4.0164283134820997E-02, -4.1552558903396519E-03, 1.6961916098881314E-03, -1.9049826801930108E-03, 3.5807763782851375E-03, 1.2870412832446880E-03, -8.9332389794084018E-04, 1.5368008718189032E-04, -1.6720057614486548E-04, 1.2417018957838041E-03, -4.6511835667683594E-03, -5.6901025514229245E-03, -7.7190855776233212E-03, -1.5379410843801808E-02, -8.5358831093853317E-03, -1.5404127754679106E-02, -1.9726704862225528E-02, -1.5513946955260387E-02, -2.5107479279612353E-02, -2.5912605877479945E-02, -2.9624351674641520E-02, -3.0140977144281055E-02, 2.3375834293130489E-03, 4.4983970046297179E-03, 4.9555411216790982E-03, 8.2805711706210989E-04, 2.3283239182851287E-03, 5.8083166393208549E-03, -8.2170588483392265E-04, -4.4963205126414001E-04, -2.7410550131390320E-03, -1.5537268447230895E-03, -1.1944769302672700E-03, -1.0445922797198467E-02, -5.7972120992286847E-03, -1.1729926774130218E-02, -9.4857673937639893E-03, -1.2771244412859930E-02, -1.7798940883354836E-02, -1.7181760207756747E-02, -2.2713375087682501E-02, -2.3273444181898070E-02, -2.6150400095114299E-02, 1.7305740214306074E-03, 4.0247474490106216E-03, 5.9559284701212667E-03, 2.5233183496939007E-03, 6.0257970157803417E-03, 8.3950406412862909E-04, 4.7207349400819184E-03, 2.5466676782001968E-03, 1.5412533575988980E-03, 2.1911311034747889E-03, -5.3196584337635846E-03, -2.7830809091810454E-03, -8.6212043010533059E-03, -6.1709567570686552E-03, -1.0562441717032283E-02, -1.1660835107739520E-02, -9.8334343810452980E-03, -1.9579211690098384E-02, -1.8130389702628393E-02, -1.6170114561454375E-02, -1.6970295015161358E-02, 4.1176109136394417E-03, 3.8452246144742436E-03, 3.4140601868062513E-04, 5.7448428612973971E-03, 3.5471275715199583E-03, 7.0425980831945630E-03, 4.6296279706079862E-03, 4.6686876852280226E-04, 3.6826381956221814E-03, -6.2588777461314879E-04, 2.2864733641871902E-03, -4.6013982624424328E-03, -2.1099352401907291E-03, -2.6888430648005254E-03, -4.0628334852923775E-03, -8.6822630873532019E-03, -9.5844300211957029E-03, -1.3144400709688231E-02, -1.3877900498537201E-02, -1.9861428495847096E-02, -1.5084991436088449E-02, 5.7351153200741552E-04, 1.5206668775278839E-03, 4.1645959953861720E-03, 4.2304208849333232E-03, 3.4881010060482357E-03, 5.2052958185745540E-03, 3.6879073488887610E-03, 7.2913280595032640E-03, -6.0430341133411232E-04, 2.3276692375773234E-03, -2.0801491986569263E-03, 3.5092075393607303E-04, -5.9400101094892657E-03, -3.1405939896726196E-03, -5.6436027228471981E-03, -4.3510358050503663E-03, -8.2465580005447597E-03, -1.0884613523688197E-02, -1.2650678940048744E-02, -1.2282851207773768E-02, -1.7155893690152978E-02, 3.4647971672040140E-03, 3.8778118603502751E-03, 1.9897639175392931E-03, 5.1490058944824784E-03, 3.9077845153772436E-03, 3.3522594731976918E-03, 3.1863877104945132E-03, 2.1659215736454956E-03, 4.6300177870200699E-03, -3.6717655965525144E-03, 2.0493350490767776E-03, -3.7146415732472382E-03, 2.3385756521993070E-03, -3.4387861465561887E-03, -3.3226742374182355E-03, -3.6478362617785747E-03, -5.7938852580364823E-03, -9.0012386374341800E-03, -8.5820098686781258E-03, -1.2597484711233800E-02, -6.4107165545621387E-03, -4.4219206587625052E-04, 3.5409728369422762E-03, 1.5506030716504018E-03, 3.5462150794425451E-03, 4.6419146459164042E-03, 4.8221574756159404E-03, 4.2140753207884412E-03, 2.3071031926012600E-03, 1.6805981766754045E-03, -7.1282854083904324E-04, 1.1821095818265101E-03, -3.5010397105251134E-04, -4.2625963709753906E-03, 9.7142977253903681E-05, -2.3293614528317286E-03, -7.3779656268595586E-04, -5.3931214981100930E-03, -4.2304667852152023E-03, -9.6527201740633558E-03, -7.7778689237645365E-03, -8.8469321875697289E-03, 1.5647110923236098E-03, 3.4843825306601489E-03, 3.5642913232026324E-03, 3.7140043405612102E-03, 1.8315655019253019E-03, 5.4239315674595072E-03, 1.9406786683562769E-03, 5.7478449363363836E-03, -1.6021001317496105E-03, 3.8766766789577328E-03, 1.4867373459381433E-03, 2.9527963131105550E-03, 2.1638824417196893E-03, -9.2717419085851748E-04, -1.7380167112282883E-03, -3.9909371092852189E-03, -4.7405905636688467E-04, -6.4822510841749947E-03, -3.2764623332171730E-03, -1.4071632195383481E-02, 3.7144536658331628E-03, 9.8407102230654159E-04, 3.1178507937695537E-03, -7.2067456665773628E-04, 8.4378524788642061E-03, 2.7056108712853475E-03, 4.5383091293385216E-03, 2.3390167210144068E-03, 1.0354712809516364E-03, 2.8715778333046568E-03, 4.8866419941047713E-03, 2.8424911019424527E-03, 1.5990712446037521E-03, 2.3210165951188439E-03, 2.4622940567880398E-03, -2.0528791205719871E-04, 3.4532149917627501E-03, -1.1506477368595418E-03, -2.5525736275444832E-03, -4.8568381771652794E-03, -8.0587156769187788E-04, -1.3389868368010973E-02, -1.1516952772472945E-03, 1.5770269582729411E-03, 2.1365706527773590E-03, 3.6219900464174006E-03, 1.4821797224202191E-03, 1.2937150911382625E-03, 1.3650933608119042E-03, 6.5297833296071289E-03, 1.8223041334837705E-03, 3.2492774099105392E-03, -5.1987092501458801E-04, 2.5080900560126734E-03, 4.0229304601387787E-03, 1.8182772358586765E-04, 2.4904037700380771E-03, 2.2335631678066232E-03, 3.4697219824187421E-03, -2.6023600469044926E-03, -1.4621853789103642E-03, -1.0974679561104697E-02, 3.0422613982802609E-03, -3.2407554635056806E-03, -7.5810724743836553E-05, 4.4988246689761120E-04, 1.8300996603650874E-03, 4.3691798169119755E-03, 2.0341956711720354E-03, 1.4636514798469032E-03, -1.5392013343294947E-03, 5.6794312180584094E-03, -1.6710625215279179E-03, 5.5202115128049805E-03, 2.6607652757961058E-03, 1.9291188217982740E-03, 2.4036387679200041E-03, 4.4598299946693228E-03, 2.1891691824577598E-03, 1.2282380168943711E-03, 3.3429353042442531E-03, -7.6163692619391817E-03, 2.6770053287924400E-03, -1.2118337582142631E-02, -2.9413039789850165E-03, -9.1793934909284436E-04, 9.3734736843227443E-04, 2.9999607885554717E-04, 3.3629973092797762E-03, 2.2187723895360965E-03, 3.5020935593846119E-03, 4.6095257527504572E-03, 2.1323632330334306E-03, 4.4215544729404171E-03, -8.4829894129954757E-04, 5.5806216413558330E-03, 3.2077916547550976E-03, 6.1764894511923182E-03, 4.3197509093757536E-04, 4.3333825547915662E-03, 3.2421242526271023E-03, -1.3183014370501201E-03, 3.9615626189350517E-03, -8.2089283575175302E-03, -2.9603824667646353E-03, -5.7255089496864118E-03, -4.3690293058786644E-03, 1.6939212697297892E-03, 9.0116650695880090E-04, 8.0106398755445000E-05, 3.6449754961879392E-05, -1.0034323607011257E-04, -6.9398871408164005E-04, 3.9207622904219993E-03, 3.8584255949951833E-03, 1.8470653109120140E-03, 5.0936884757871431E-03, 3.5774343700642392E-03, 3.2851203304462419E-03, 7.0060753422670980E-03, 5.3325450091458899E-03, 4.4254354245013752E-03, 9.3586866002356751E-03, -6.4344420192029772E-04, 6.2534072535912373E-03, -7.1077195681172236E-03, -3.4882452684638137E-03, 9.5507460545756891E-05, -4.3887594314796184E-03, 8.3814192606591236E-04, 1.7103785694737707E-04, 7.2948514732402319E-04, 1.3471849426735395E-03, 1.3325077618555853E-03, -4.8245280489381313E-04, 3.7652048455131234E-03, 2.8476023426079159E-03, 3.7417180748714300E-03, 5.1411127971274498E-03, 7.8057448605044089E-03, 3.0091675591413926E-03, 6.3918467365346177E-03, 6.2014422935983112E-03, 3.1094246259265280E-03, 8.7039171099801936E-03, -2.2821220189666695E-03, -2.1507385710639376E-03, -5.4337141602002160E-03, -2.1118866935064826E-03, -6.9503689570036306E-04, 1.2305067968410555E-03, -4.4275474013255085E-04, 8.8321196639474543E-05, -3.2804166326217145E-03, 9.8267019433858683E-04, 5.4290636145322164E-03, 1.7701944974680443E-03, 3.9731928816905916E-03, 4.4371549691189418E-03, 5.6974509387871962E-03, 5.8080507427568616E-03, 6.4782554254485449E-03, 4.5444146775693575E-03, 6.5684738168019707E-03, 4.0440105999976911E-03, -2.4694461925659776E-03, 8.8751905064664450E-03, -2.5239953856284968E-03, -2.7183397405068492E-03, 1.8646860557711658E-03, 4.4089106721284944E-04, 1.6711100141022803E-04, 5.0679235988663135E-03, 2.6156560347319210E-03, 3.8519268649301144E-03, -2.2430375283985639E-03, 4.1474222609091844E-03, 2.7516121336007694E-03, 3.5385720939460266E-03, 6.8316036788463545E-03, 7.3119940396370649E-03, 8.4634522403561133E-03, 8.9266446337590323E-03, 6.0487441277132055E-03, 9.5571150119030598E-03, 2.3347640552780487E-03, 1.2838979594241793E-02, -3.9602766869716692E-03, -4.2611329613934570E-03, -1.5045304614449309E-03, -2.9455558760921210E-03, 2.8187613370384739E-04, 1.8940863233695162E-03, 8.8806475761308125E-04, 5.0691017820082588E-03, 9.5645900247076361E-04, 3.9564115851538125E-03, 4.7318990852062530E-03, 1.4086585921925876E-03, 6.1383932741361840E-03, 3.2789805247510004E-03, 8.6199727282472403E-03, 6.6592106759371158E-03, 7.0180774228635993E-03, 1.1723061273461205E-02, 7.0352371720074358E-03, 1.0653579794799495E-02, 5.4634386679859835E-03, 1.1090547129184018E-03, 5.8744132536944311E-03, -8.1755366790234579E-03, -3.8540917512968617E-04, 9.4105504814237474E-04, 3.1505178772337798E-03, 3.9155812161056971E-03, 9.4341141213246521E-04, 6.1506925117522987E-03, 1.9713155113054086E-03, 2.6943688339893072E-03, 5.8392128436095094E-03, 4.6652503499819403E-03, 8.8445665068258641E-03, 7.4831171309622298E-03, 8.7123969519928481E-03, 9.9911957277936374E-03, 7.2386557892605407E-03, 1.2835886656342079E-02, 5.9107023501408767E-03, 8.2742705477635570E-03, 5.8068332593389669E-03, -4.4467187163830671E-03, 3.3997866775486519E-04, -3.2390556004089255E-03, -5.2961038494492201E-03, -2.2442317772102998E-03, -8.8535805311447903E-05, -3.0282977257413624E-04, 2.7296618235423506E-03, 9.6763375221108430E-04, 3.1644939430929791E-03, 1.4820004937385778E-04, 1.0034260747121012E-02, 3.7978422874563912E-03, 8.4830357420375580E-03, 5.5199963660366542E-03, 8.0872245194918424E-03, 6.7744840027604940E-03, 2.1832377354407432E-03, 7.1726228726200639E-03, 8.4227952994015212E-03, -4.2195544242699919E-03, -2.0187038603493375E-03, -7.4979246863281978E-03, -3.1951960182229448E-03, -1.0332926067419743E-02, -6.9621514365490961E-04, -4.3446497121633264E-04, -2.2505257332880601E-04, 1.6139785830804403E-03, 1.1440768469563592E-03, 2.1542556126629008E-03, 5.2129954327954191E-03, 3.4473466267819883E-03, 6.2892081255082645E-03, 4.5282343887456849E-03, 9.3910967226663207E-03, 6.2510587042814173E-03, 5.6759457926922616E-03, 4.2895342100224510E-03, 4.6936889129582243E-03, 2.5615066448275402E-03, 4.1443996043759538E-03, -4.4333099999999999E-04};
    int nx = 24;
    int ny = 24;
    int kx = 2;
    int ky = 2;

    double h [] = {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};
    double hh [] = {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};
    double w_x [] = {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};
    double w_y [] = {0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0};

    int i, j, li, lj, lx, ky1, nky1, ly, i1, j1, l2;
    double f, temp;

    int kx1 = kx+1;
    int nkx1 = nx-kx1;
    int l = kx1;
    int l1 = l+1;

    while ((x_in >= tx[l1-1]) && (l != nkx1))
    {
        l = l1;
        l1 = l+1;
    }
    
    h[0] = 1.0;
    for (j = 1; j < kx+1; j++)
    {
        for (i = 0; i < j; i++)
        {
            hh[i] = h[i];
        }
        h[0] = 0.0;
        for (i = 0; i < j; i++)
        {
            li = l+i;
            lj = li-j;
            if (tx[li] != tx[lj])
            {
                f = hh[i] / (tx[li] - tx[lj]);
                h[i] = h[i] + f * (tx[li] - x_in);
                h[i+1] = f * (x_in - tx[lj]);
            }
            else
            {
                h[i+1-1] = 0.0;
            }
        }
    }
    
    lx = l-kx1;
    for (j = 0; j < kx1; j++)
    {
        w_x[j] = h[j];
    }

    ky1 = ky+1;
    nky1 = ny-ky1;
    l = ky1;
    l1 = l+1;

    while ((y_in >= ty[l1-1]) && (l != nky1))
    {
        l = l1;
        l1 = l+1;
    }
    
    h[0] = 1.0;
    for (j = 1; j < ky+1; j++)
    {
        for (i = 0; i < j; i++)
        {
            hh[i] = h[i];
        }
        h[0] = 0.0;
        for (i = 0; i < j; i++)
        {
            li = l+i;
            lj = li-j;
            if (ty[li] != ty[lj])
            {
                f = hh[i] / (ty[li] - ty[lj]);
                h[i] = h[i] + f * (ty[li] - y_in);
                h[i+1] = f * (y_in - ty[lj]);
            }
            else
            {
                h[i+1-1] = 0.0;
            }
        }
    }

    ly = l-ky1;
    for (j = 0; j < ky1; j++)
    {
        w_y[j] = h[j];
    }

    l = lx*nky1;
    for (i1 = 0; i1 < kx1; i1++)
    {
        h[i1] = w_x[i1];
    }
        
    l1 = l+ly;
    temp = 0.0;
    for (i1 = 0; i1 < kx1; i1++)
    {
        l2 = l1;
        for (j1 = 0; j1 < ky1; j1++)
        {
            l2 = l2+1;
            temp = temp + coeff[l2-1] * h[i1] * w_y[j1];
        }
        l1 = l1+nky1;
    }
        
    return temp;
}
